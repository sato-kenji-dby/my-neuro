# Live2D 交互问题故障排查日志

## 1. 初始问题描述
1.  **交互范围过大**：Live2D 模型的可交互区域比模型本身的可视范围要大。
2.  **初始交互失效**：应用启动时，无法立即与 Live2D 模型进行交互，鼠标指针会直接“穿透”模型。必须先与其他 UI 元素交互才能“唤醒”模型。

## 2. 解决方案探索与尝试

### 2.1 修复交互范围问题
*   **分析**：当 `hitArea` 未定义时，PIXI.js 默认使用模型的几何边界框作为交互区域，这个边界框通常大于模型的实际渲染区域。
*   **失败的尝试**：尝试将模型内部定义的点击区域集合直接赋值给 `hitArea` 属性，导致 TypeScript 编译错误，因为类型不匹配。
*   **成功的结论**：深入研究 `pixi-live2d-display` 库的行为后发现，当 `model.interactive = true;` 被设置时，库的默认 `containsPoint` 方法会自动使用 `internalModel.hitAreas` 进行精确的命中测试。因此，无需手动设置 `hitArea`。

### 2.2 修复初始交互失效问题
*   **分析**：根源在于 Electron 主进程在创建窗口时，默认设置了 `setIgnoreMouseEvents(true, { forward: true })`，导致整个窗口启动时就是鼠标穿透的。渲染进程需要通过 IPC 向主进程发送消息来动态改变这个状态，但启动时没有任何事件触发第一个 `{ ignore: false }` 消息，导致了交互死锁。
*   **失败的尝试 A**：在模型加载完成后，立即发送 `setIgnoreMouse(false)` 来禁用穿透，然后用 `setTimeout` 检查当前鼠标指针是否在模型上，如果不在，则重新启用穿透。此方案不稳定。
*   **失败的尝试 B**：在模型加载后，强制禁用穿透 2 秒，然后无条件地重新启用穿透。在 2 秒窗口期结束后，如果鼠标没有恰好在模型上，问题依然重现。

## 3. 当前状态与结论
*   **交互范围问题**：已解决。
*   **初始交互失效问题**：**未解决**。此问题被归类为**已知问题**。由于用户可以通过将鼠标移至其他UI元素上轻松绕开此问题，因此暂时搁置。
